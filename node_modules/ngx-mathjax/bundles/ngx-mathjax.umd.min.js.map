{"version":3,"sources":["../../node_modules/tslib/tslib.es6.js","../../src/app/math-jax/math-jax.service.ts","../../src/app/math-jax/math-jax.directive.ts","../../src/app/math-jax/math-jax.module.ts"],"names":["Object","create","__read","o","n","m","Symbol","iterator","r","e","i","call","ar","next","done","push","value","error","MathJaxService","this","MathJaxHub$","ReplaySubject","prototype","init","window","mathJaxHub$","Injectable","MathJaxDirective","el","service","_this","expressionChangeSubject","mathJaxTypesetSubject","Subject","element","nativeElement","typesetSubscription","combineLatest","subscribe","MathJax","Hub","Queue","allJax$","pipe","map","getAllJax","expressionChangeSubscription","_a","_b","jax","forEach","v","isDestroying","order","Text","ngAfterViewInit","hubSubscription","MathJaxTypeset","ngOnChanges","changes","expressions","MathJaxExpressions","currentValue","Array","updateValues","cv","previousValue","undefined","filter","ngOnDestroy","unsubscribe","complete","Directive","args","selector","ElementRef","Input","MathJaxModule","moduleConfig","script","mathJaxHubConfig","Config","skipStartupTypeset","messageStyle","tex2jax","preview","Register","StartupHook","toString","document","createElement","type","text","getElementsByTagName","appendChild","version","config","hostname","src","async","forRoot","moduleConfiguration","ngModule","providers","provide","ModuleConfiguration","useValue","useClass","forChild","NgModule","declarations","imports","CommonModule","exports"],"mappings":"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","sourcesContent":["/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport var __createBinding = Object.create ? (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    Object.defineProperty(o, k2, { enumerable: true, get: function() { return m[k]; } });\r\n}) : (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    o[k2] = m[k];\r\n});\r\n\r\nexport function __exportStar(m, exports) {\r\n    for (var p in m) if (p !== \"default\" && !exports.hasOwnProperty(p)) __createBinding(exports, m, p);\r\n}\r\n\r\nexport function __values(o) {\r\n    var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\r\n    if (m) return m.call(o);\r\n    if (o && typeof o.length === \"number\") return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n    throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\nexport function __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n};\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nvar __setModuleDefault = Object.create ? (function(o, v) {\r\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\r\n}) : function(o, v) {\r\n    o[\"default\"] = v;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\r\n    __setModuleDefault(result, mod);\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n\r\nexport function __classPrivateFieldGet(receiver, privateMap) {\r\n    if (!privateMap.has(receiver)) {\r\n        throw new TypeError(\"attempted to get private field on non-instance\");\r\n    }\r\n    return privateMap.get(receiver);\r\n}\r\n\r\nexport function __classPrivateFieldSet(receiver, privateMap, value) {\r\n    if (!privateMap.has(receiver)) {\r\n        throw new TypeError(\"attempted to set private field on non-instance\");\r\n    }\r\n    privateMap.set(receiver, value);\r\n    return value;\r\n}\r\n","/* eslint-disable @typescript-eslint/no-explicit-any */\nimport { Injectable } from '@angular/core';\nimport { ReplaySubject, Subject } from 'rxjs';\n\n/**\n * Defines global variables on the `window` object.\n */\ndeclare global {\n  interface Window {\n    /**\n     * Subject to notify the readiness of the MathJax namespace.\n     */\n    mathJaxHub$: Subject<any>;\n  }\n}\n\n/**\n * A internal utility service.\n */\n@Injectable()\nexport class MathJaxService {\n  /**\n   * Signals when the MathJax object is ready.\n   */\n  public readonly MathJaxHub$ = new ReplaySubject<any>();\n\n  /**\n   * Must call `init` method explicitly during module initialization.\n   */\n  public init(): void {\n    /**\n     * Create a global variable.\n     */\n    window.mathJaxHub$ = this.MathJaxHub$;\n  }\n}\n","/* eslint-disable @typescript-eslint/no-explicit-any */\n/**\n * @author davidshen84\n */\nimport { UpdateValue } from './domain/interfaces';\nimport {\n  AfterViewInit,\n  Directive,\n  ElementRef,\n  Input,\n  OnChanges,\n  OnDestroy,\n  SimpleChanges,\n} from '@angular/core';\nimport {\n  combineLatest,\n  Observable,\n  ReplaySubject,\n  Subject,\n  Subscription,\n} from 'rxjs';\nimport { MathJaxService } from './math-jax.service';\nimport { map } from 'rxjs/operators';\n\n/**\n * Typeset the content or expressions using MathJax library.\n */\n@Directive({\n  selector: 'mathjax, [mathjax]',\n})\nexport class MathJaxDirective implements AfterViewInit, OnChanges, OnDestroy {\n  /**\n   * An array of input MathJax expressions.\n   */\n  @Input('mathjax')\n  public MathJaxExpressions: string[];\n  private readonly mathJaxHub$: Observable<any>;\n  /**\n   * The associated native element.\n   */\n  private readonly element: HTMLElement;\n  /**\n   * Observes the change of the input expression.\n   */\n  private expressionChangeSubject = new ReplaySubject<UpdateValue<string>[]>();\n  /**\n   * Observes the completion of the initial MathJax typesetting.\n   */\n  private readonly mathJaxTypesetSubject = new Subject<any>();\n  private readonly expressionChangeSubscription: Subscription;\n  /**\n   * Observe the readiness of all the Jax instances in the element.\n   */\n  private readonly allJax$: Observable<any[]>;\n  private readonly typesetSubscription: Subscription;\n  private hubSubscription: Subscription;\n  private isDestroying: boolean;\n\n  constructor(el: ElementRef, service: MathJaxService) {\n    this.mathJaxHub$ = service.MathJaxHub$;\n    this.element = el.nativeElement;\n\n    this.typesetSubscription = combineLatest([\n      this.mathJaxHub$,\n      this.mathJaxTypesetSubject,\n    ]).subscribe(() => {\n      MathJax.Hub.Queue(['Typeset', MathJax.Hub, this.element]);\n    });\n\n    this.allJax$ = combineLatest([\n      this.mathJaxHub$,\n      this.mathJaxTypesetSubject,\n    ]).pipe(map(() => MathJax.Hub.getAllJax(this.element)));\n\n    this.expressionChangeSubscription = combineLatest([\n      this.allJax$,\n      this.expressionChangeSubject,\n    ]).subscribe(([jax, updateValue]) =>\n      updateValue.forEach((v) =>\n        MathJax.Hub.Queue(() => {\n          // Stop pushing messages to the queue when the component is being destroyed.\n          if (!this.isDestroying) {\n            return jax[v.order].Text(v.value);\n          }\n        })\n      )\n    );\n  }\n\n  ngAfterViewInit(): void {\n    this.hubSubscription = this.mathJaxHub$.subscribe(() => {\n      MathJax.Hub.Queue(['Typeset', MathJax.Hub, this.element]);\n      MathJax.Hub.Queue(['MathJaxTypeset', this]);\n    });\n  }\n\n  /**\n   * Explicitly trigger the MathJax typeset process.\n   *\n   * This is useful if the content is loaded dynamically.\n   */\n  MathJaxTypeset(): void {\n    this.mathJaxTypesetSubject.next();\n  }\n\n  ngOnChanges(changes: SimpleChanges): void {\n    const expressions = changes.MathJaxExpressions;\n\n    // Shortcut if there's nothing to update.\n    if (!(expressions.currentValue instanceof Array)) {\n      return;\n    }\n\n    // Update only the changed expressions.\n    const updateValues: UpdateValue<string>[] = expressions.currentValue\n      .map((cv, i) =>\n        (expressions.previousValue ? expressions.previousValue[i] !== cv : true)\n          ? {\n              value: expressions.currentValue[i],\n              order: i,\n            }\n          : undefined\n      )\n      .filter((v) => v);\n    this.expressionChangeSubject.next(updateValues);\n  }\n\n  ngOnDestroy(): void {\n    this.isDestroying = true;\n\n    this.expressionChangeSubscription.unsubscribe();\n    this.hubSubscription.unsubscribe();\n    this.typesetSubscription.unsubscribe();\n\n    this.mathJaxTypesetSubject.complete();\n    this.expressionChangeSubject.complete();\n  }\n}\n","/**\n * @author davidshen84\n */\n\nimport { ModuleWithProviders, NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { MathJaxDirective } from './math-jax.directive';\nimport { MathJaxService } from './math-jax.service';\n\n/**\n * Module configuration class.\n *\n * @example\n *\n * {\n *   version: '2.7.5',\n *   config: 'TeX-AMS_HTML',\n *   hostname: 'cdnjs.cloudflare.com'\n * }\n */\nexport class ModuleConfiguration {\n  /**\n   * The version of the MathJax library.\n   */\n  version: string;\n\n  /**\n   * The config name of the MathJax library.\n   * Please check the MathJax [documentation](https://docs.mathjax.org/en/latest/config-files.html) for all the configuration names.\n   */\n  config: string;\n\n  /**\n   * MathJax CDN hostname. Please check [here](https://docs.mathjax.org/en/latest/start.html#mathjax-cdn) for available CDN servers.\n   */\n  hostname: string;\n}\n\n/**\n * Module to load and configure the MathJax library.\n *\n * @example\n *\n * MathJaxModule.config(\n * {\n *     version: '2.7.5',\n *     config: 'TeX-AMS_HTML',\n *     hostname: 'cdnjs.cloudflare.com'\n * })\n */\n@NgModule({\n  declarations: [MathJaxDirective],\n  imports: [CommonModule],\n  exports: [MathJaxDirective],\n})\nexport class MathJaxModule {\n  constructor(service: MathJaxService, moduleConfig?: ModuleConfiguration) {\n    service.init();\n\n    /**\n     * Define the **function string** to be inserted into the mathjax configuration script block.\n     */\n    const mathJaxHubConfig = (() => {\n      MathJax.Hub.Config({\n        skipStartupTypeset: true,\n        messageStyle: 'none',\n        tex2jax: { preview: 'none' },\n      });\n      MathJax.Hub.Register.StartupHook('End', () => {\n        window.mathJaxHub$.next();\n        window.mathJaxHub$.complete();\n      });\n    }).toString();\n\n    if (moduleConfig) {\n      /**\n       * Insert the MathJax configuration script into the Head element.\n       */\n      (function () {\n        const script = document.createElement('script') as HTMLScriptElement;\n        script.type = 'text/x-mathjax-config';\n        script.text = `(${mathJaxHubConfig})();`;\n        document.getElementsByTagName('head')[0].appendChild(script);\n      })();\n\n      /**\n       * Insert the script block to load the MathJax library.\n       */\n      (function (version: string, config: string, hostname: string) {\n        const script = document.createElement('script') as HTMLScriptElement;\n        script.type = 'text/javascript';\n        script.src = `https://${hostname}/ajax/libs/mathjax/${version}/MathJax.js?config=${config}`;\n        script.async = true;\n        document.getElementsByTagName('head')[0].appendChild(script);\n      })(moduleConfig.version, moduleConfig.config, moduleConfig.hostname);\n    }\n  }\n\n  /**\n   * Configure the provider for hte module.\n   *\n   * @deprecated Use forRoot or forChild method instead.\n   * @param {boolean} forRoot Make sure it is set to `true` for the root module and `false` for any child module.\n   * @param {ModuleConfiguration} moduleConfiguration A {ModuleConfiguration} instance.\n   *\n   * @return {ModuleWithproviders<MathJaxModule>} instance\n   */\n  public static config(\n    forRoot = true,\n    moduleConfiguration: ModuleConfiguration = {\n      version: '2.7.5',\n      config: 'TeX-AMS_HTML',\n      hostname: 'cdnjs.cloudflare.com',\n    }\n  ): ModuleWithProviders<MathJaxModule> {\n    return forRoot\n      ? {\n          ngModule: MathJaxModule,\n          providers: [\n            { provide: ModuleConfiguration, useValue: moduleConfiguration },\n            { provide: MathJaxService, useClass: MathJaxService },\n          ],\n        }\n      : {\n          ngModule: MathJaxModule,\n        };\n  }\n\n  /**\n   * Configure the module for the root module.\n   *\n   * @param {ModuleConfiguration} moduleConfiguration configuration\n   *\n   * @return {ModuleWithproviders<MathJaxModule>}\n   */\n  public static forRoot(\n    moduleConfiguration: ModuleConfiguration = {\n      version: '2.7.5',\n      config: 'TeX-AMS_HTML',\n      hostname: 'cdnjs.cloudflare.com',\n    }\n  ): ModuleWithProviders<MathJaxModule> {\n    return {\n      ngModule: MathJaxModule,\n      providers: [\n        { provide: ModuleConfiguration, useValue: moduleConfiguration },\n        { provide: MathJaxService, useClass: MathJaxService },\n      ],\n    };\n  }\n\n  /**\n   * Configure the module for a child module.\n   *\n   * @return {object}\n   */\n  public static forChild(): ModuleWithProviders<MathJaxModule> {\n    return {\n      ngModule: MathJaxModule,\n    };\n  }\n}\n"]}